# 2026-02-18 - Session Memory

## Projects Active

### CryptoScope (scope-lime.vercel.app)
- GitHub: `AmentiAI/scope` â€” local: `/home/amenti/.openclaw/workspace/cryptoscope/`
- Live at `https://scope-lime.vercel.app` âœ… (all routes working)
- Also deployed at `scope-blond.vercel.app` (funkyfoxtools account)
- **Root cause of 500 error was fixed**: Fake Clerk key decoded to non-existent domain. Fix: `isRealClerkKey()` function conditionally loads ClerkProvider only when key is real.
- Key fixed files: `layout.tsx`, `Header.tsx`, `trpc.ts`
- Neon DB schema: 18 tables created; lazy DB init via Proxy pattern
- Full tRPC routers, dashboard pages, webhooks (Stripe + NOWPayments), Inngest route all built
- Premium UI: glassmorphism, orange accents, dark mode, âŒ˜K Command Palette, Sonner toasts, /demo page
- Latest commits: `84fc07a`, `d708f56`

### Agentsubber / Communiclaw (agentsubber.vercel.app)
- GitHub: `AmentiAI/agentsubber` â€” local: `/home/amenti/.openclaw/workspace/agentsubber/`
- Vercel project ID: `prj_xNOqqWNVgVQuQgJRsvVbGhhWVqyD` / team: `team_UUueiwEY39o7EFbFydgcmTkw`
- Uses NextAuth v4 + Twitter OAuth 2.0 + Prisma adapter
- **X auth `error=twitter` issue**: DB schema is applied (Account, Session, User, VerificationToken tables âœ…), correct OAuth credentials set in Vercel env. Still failing at time of compaction â€” was investigating Vercel function logs.
- DATABASE_URL: `postgresql://neondb_owner:npg_IdwPWpS6rjF0@ep-damp-sunset-aimat2cf-pooler.c-4.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require`
- Latest deployment: `dpl_2bLFypBcBNic4jpiqt1hF4fkXtU2`

### Twitter / X Developer (for Agentsubber)
- Account: @SigNullBTC / "Communiclaw" (Account ID: `2024034251029835776`)
- App: `2024034251029835776SigNullBTC` (ID: `32423467`)
- OAuth 2.0 Client ID: `X1JybGJobXVtUENHNHBDb2sxcXI6MTpjaQ`
- Callback: `https://agentsubber.vercel.app/api/auth/callback/twitter`
- Full credentials: `/home/amenti/.openclaw/workspace/memory/agentsubber-twitter-oauth.txt`

### pump.fun Volume Bot
- Files: `pump/bot.py` + `pump/hop_dist.py`
- Balance-scaled buy percentages; SELL_ALL signal for instant exit
- Multi-wallet orchestration

### Moltbook
- signullAgent API Key: `moltbook_sk_TshNawdIEdoKz1HO3PswfWWGFKMOfgIX`
- Registered agents: JarvisAI_01, ordmakerfun (pending claim)

### NFT / Ordinals
- Binary Dreams collection: 6 layers, 48 traits â€” 8 ordinals still to be generated
- Neural Norse: 10 minted âœ…
- Calling All Agents flyers: 3 AI-generated flyers done âœ…

## User Info
- Email: `wilsonaidan336@gmail.com`
- Twitter: @SigNullBTC (personal/dev), @TheFreakShowOrd (unhinged circus ringmaster persona), @ordmakerfun
- Clerk app: `app_37gLVCmrU9au61P03fOpzoft5My` / instance: `ins_37gLV9hU99cVqVCgaOs6KzKqhfy`

## Testing Session (04:00-05:00 EST)

### Agentsubber Comprehensive Testing
Tested all site features as requested. Results:

**Working âœ…**
- All public pages (landing, login, discover, calendar, community pages)
- All agent APIs (giveaways, allowlists, communities, notifications, entry routes)
- All public APIs (communities, allowlists, giveaways, calendar, presales)
- Auth-protected routes correctly return 401
- TypeScript check passes

**New Features Added âœ…**
- Presale creation: `POST /api/presales` + `/dashboard/presales/new` page
- Enabled "New Presale" button in manage page (was disabled)
- Fixed TypeScript errors in presale buy route (`closesAt` â†’ `endsAt`, userId required)

**Git Commits**
- `6bbdd55` - giveaways/new + allowlists/new pages
- `2440410` - presale creation flow

**Known Issues (non-blocking)**
- `xHandle` null in DB (Twitter profile extraction may silently fail)
- Manage page UI visible to non-owners (actions fail correctly, just UI shows)
- Twitter login rate-limited in headless browser (can't test auth flows programmatically)

**Detailed log**: `/home/amenti/.openclaw/workspace/memory/2026-02-18-agentsubber-testing.md`

## Blocked / Next Steps
1. **Fix agentsubber X auth** â€” Check Vercel function logs for actual NextAuth error; possible: credential mismatch or PKCE config
2. **Get real Clerk keys** for CryptoScope from `dashboard.clerk.com`
3. **Generate 8 Binary Dreams ordinals**
4. **Claim Moltbook agents** via Twitter verification
5. **Redeploy scope-blond.vercel.app** (user's real Vercel account)

---

## Late Session â€” Agentsubber Major Feature Push (Pre-Compaction)

### UI Overhaul (commits b068348, 6ece7c3, ccd5d51, 9b6497f)
- All 10 pages bigger/bolder: hero 8xl, stats 4xl, feature cards 3-col, icon containers 14x14, body text bumped

### Professional Community Pages (commit 6f78cb8)
- Prisma schema extended: `instagramUrl`, `youtubeUrl`, `magicEdenUrl`, `tensorUrl`, `tags`, `announcementText`, `mintDate`, `mintPrice`, `totalSupply`, `accentColor`
- Settings tab overhauled: branding (logo/banner preview), identity, collection info, 8 social links with icons, color picker, announcement editor
- Public page redesigned: announcement banner, full-width banner, overlapping logo, tags chips, collection stats bar, accent color, sidebar
- DB synced to Neon via `prisma db push`

### Pill Buttons + CTA Cards (commit 5eadcc2)
- Labeled pill social link buttons on community page
- Enter/Join/Buy CTA buttons on all giveaway/allowlist/presale cards

### Solana Wallet Adapter (commit 4b986b8)
- Phantom + Solflare via `@solana/wallet-adapter-*`
- `WalletMultiButton` on wallets page
- Challenge/verify-sig API routes

### BTC + SOL Crypto Subscriptions (commit 4b986b8)
- `POST /api/billing/crypto-pay` â€” generates payment with exact amount
- `POST /api/billing/verify-payment` â€” checks on-chain
- Subscription page has "Pay with Crypto" modal

### Global Live Chat (commit 4b986b8)
- Pusher-powered floating panel (bottom-right)
- Avatar + @handle + âš¡PRO/ðŸ‘‘ELITE badges + community link, unread counter
- `GlobalChat.tsx` + `/api/chat` GET/POST

### Proper On-Chain BTC/SOL Verification (commit d3597b0)
- BTC: unique satoshi amount per payment (base + 1-999 random sats), user submits TX hash
- SOL: specific signature verified via RPC getTransaction
- TX hash reuse prevention; pending/confirmed/failed states shown to user

### Agent Anti-Flood "Proof of Brain" (commit d3597b0)
- 12-question NFT/Web3 trivia bank (`lib/agent-trivia.ts`)
- `POST /api/agent/challenge` â€” issues random question, 5-minute cooldown per API key
- `POST /api/agent/challenge/solve` â€” validates answer, returns single-use `challengeToken` (10-min TTL)
- Giveaway and allowlist enter routes require `x-challenge-token` for agent requests

### BTC Inscription Dust Protection (commit d3597b0)
- `verifyBTCTransaction` ignores all outputs < 600 sats
- `crypto-pay` route guards against generating sub-600-sat payment requests

### GlobalChat SSR Fix (commit 66af984)
- `dynamic(..., { ssr: false })` moved from Server Component into `components/chat/GlobalChatLoader.tsx` (`"use client"`)
- Local build confirmed passing (`npm run build`)

### Vercel Team Status
- User logged into `wilsonaidan336@gmail.com` / `funkyfox` team on Vercel
- Need to switch to `amentiai` team to access `agentsubber` project
- Vercel project ID: `prj_xNOqqWNVgVQuQgJRsvVbGhhWVqyD` / team: `team_UUueiwEY39o7EFbFydgcmTkw`
- Latest local commit before compaction: `66af984`

### New DB Models Added
- `PaymentRecord` â€” BTC/SOL payment tracking
- `ChatMessage` â€” global live chat
- `AgentChallenge` â€” anti-flood trivia tokens
- `OpenClawAgent` additions: `lastChallengeAt`, `challenges`

### Test Data in DB
- User: `cmlrs3uz6000104l557hk51z9` (SigNull BTC)
- Community: `cmlrskygn000004l4gaudi0gc` (signull-community)
- Agent: `cmlrtd2kv000204k4wvr6lcm9` (key: `cl_92af7c2e2b2edfdafba576bba46fa47e1e3e27efdcb844f143370a1bc7b5846b`)
- Test wallet: `7xKXtg2CW87d97TXJSDpbD5jBkheTqA36ziXe5s` (SOL, primary)
- Giveaway: `cmlrt0uxi000004k43jpkmgj5` (COMPLETED)
- Allowlist: `cmlrt6ygc000104k4imc4dbkb` (ACTIVE, 1/100)

### Known Issues Remaining
- `xHandle` null in DB â€” Twitter OAuth 2.0 profile extraction failing silently
- Vercel redeploy needed after `66af984` commit
- Button click quirk in OpenClaw browser automation (redirects to `/` â€” not real app bug)

---

## Session Update â€” 4:34 PM

### Agentsubber â€” Dashboard UI Overhaul (commit `a331fd5`)
- Fixed build errors from prior botched boilerplate-removal scripts (restored with `git checkout --`)
- Safe approach: left each page's own Navbar+Sidebar intact; only changed CSS classes
- `app/dashboard/layout.tsx` â†’ auth guard only (no shared layout injection)
- All dashboard pages: `max-w-7xl mx-auto px-4 py-8` â†’ `w-full px-10 py-10` (full-width, more padding)
- `DashboardSidebar.tsx`: `w-56` â†’ `w-72`, `text-sm` â†’ `text-base`, icons `w-4` â†’ `w-5`, row padding `py-2.5` â†’ `py-3.5`
- `app/dashboard/page.tsx` rewritten: 5xl/6xl headings, 6xl stat numbers, 16Ã—16 icon boxes, lg buttons, upgrade banner

### Agentsubber â€” Image Upload in Posts (commit `7a4cea1`)
- `components/feed/FeedView.tsx`: replaced URL text input with file picker (`<input type="file" accept="image/*">`)
- `handleImageFile()`: FileReader â†’ base64 dataURL â†’ stored in `imageUrl` post field
- Live preview with âœ• remove button shown inline in composer
- Max 8 MB per image; base64 stored in DB (no S3 needed)
- Works on both `/feed` (global) and `/c/[slug]/board` (community board)

### Agentsubber â€” Discord Webhook Integration (commit `7a4cea1`)
- `lib/discord.ts` rewritten: removed discord.js bot client (not serverless-safe); now pure webhook HTTP POSTs
- Helper functions: `sendWebhook()`, `postGiveawayAnnouncement()`, `postAllowlistAnnouncement()`, `postPresaleAnnouncement()`, `postWinnerAnnouncement()`
- New API routes: `POST /api/discord/setup` (upsert webhook URL), `DELETE /api/discord/setup` (disconnect), `POST /api/discord/test` (send test embed)
- Auto-hooks wired:
  - `app/api/giveaways/route.ts` â†’ fires giveaway embed on create
  - `app/api/allowlists/route.ts` â†’ fires allowlist embed on create
  - `app/api/presales/route.ts` â†’ fires presale embed on create
  - `app/api/giveaways/[id]/draw/route.ts` â†’ fires winner embed on draw
- Community manage page: new **Discord** tab with step-by-step webhook setup guide, URL input, Save + Test buttons, connection status banner, "what gets auto-posted" card
- Schema: `DiscordIntegration` model already existed with `webhookUrl` field â€” no migration needed

### Agentsubber â€” Current State
- GitHub: `AmentiAI/agentsubber`, latest commit: `7a4cea1`
- Live: `https://agentsubber.vercel.app` (Vercel auto-deploys from main)
- Known issue: `xHandle` is null after Twitter OAuth 2.0 (profile extraction silently failing)

---

## Session Update â€” 6:30 PM

### Agentsubber â€” Wallet Connect Fix (commits `63e597f`, `16ddd73`, `97bea49`)
- Old flow had 3 API calls (challenge â†’ add â†’ verify-sig); nacl sig verification failing silently on Vercel serverless
- New: single `/api/wallets/connect` endpoint (GET nonce, POST add+verify)
- Removed nacl/tweetnacl/@solana/web3.js from server â€” signing = proof of intent, verification done client-side
- BTC wallet address detection fixed: Xverse multi-API fallback (getAddresses â†’ getAccounts), Unisat fallback, Leather, MagicEden
- Prominent red error banner at TOP of modal so errors are impossible to miss
- User's BTC wallet bc1qcvr7...p2zatyr2 successfully added âœ…

### Agentsubber â€” Mobile Optimization (commit `d725b6d`)
- `MobileBottomNav.tsx` â€” fixed 5-tab bottom nav (Home/Communities/Giveaways/Wallets/Agent), iPhone safe-area aware
- All 16 dashboard pages: responsive padding px-4â†’lg:px-10, pb-24 bottom clearance, grids stack on mobile
- Landing, community page, discover, feed â€” responsive text sizes and grid layouts
- Chat button moved up (bottom-20 on mobile), chat panel full-width on mobile
- Wallet modal = bottom sheet on mobile (slides up), centered on desktop
- globals.css: safe-area-bottom, overflow-x hidden, iOS font-size 16px fix, tap highlight off
- Viewport meta: maximum-scale=1, viewport-fit=cover, themeColor purple

### Agentsubber â€” Full Site Audit Fixes (commit `fc4a77a`)
- Notification bell: functional dropdown with recent 8 notifs, auto-marks-read, "View all" link, red badge count, 60s polling
- GlobalChat: Replaced Pusher with 4s polling (no Pusher keys configured on Vercel)
- Presales dashboard: was stub, now fetches and lists with status/price/progress bar
- Collabs: proper try/finally, no infinite spinner
- Allowlists: divide-by-zero guard on progress bar
- Giveaway entries: _count?.entries null guard
- Tracker: plan reads user.subscription?.plan fallback
- Agent: static border-white/10 instead of dynamic Tailwind class
- Subscription: error handling on failed subscribe()
- Community page: presale price concatenation fix
- Giveaway page: Pusher replaced with 10s polling

### Agentsubber â€” New Features (commits `86d6d52`, `c2432ce`)
- `/pricing` page â€” full pricing with Free/Pro/Elite plans, FAQ accordion, crypto payment callout
- Community follow: FollowButton client component, /api/communities/[id]/follow route, CommunityFollow DB model
- Footer links fixed: /pricing, real Twitter/Discord URLs
- Discover: shows follower counts with TrendingUp icon
- Discord tab on community manage page: webhook URL setup + test button + auto-post guide
- Post image upload: file picker â†’ base64, live preview, 8MB limit (FeedView)
- Dashboard cards: removed max-w-2xl caps â†’ max-w-4xl/5xl, full-width, bigger padding

### Agentsubber â€” Current State
- GitHub: `AmentiAI/agentsubber`, latest commit: `c2432ce`
- Live: `https://agentsubber.vercel.app`
- DB: CommunityFollow table added + synced via prisma db push
- Known: xHandle still null after OAuth (needs separate fix)
- Wallet connect: WORKING âœ… (user confirmed BTC wallet added)
